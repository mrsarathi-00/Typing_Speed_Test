package typespeedtest;

import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

class speedtype{
    private static long startTime = 0;
    private static boolean timerStarted = false;

    public static void main(String[] args) {
        launchApp();
    }

    private static void launchApp() {

        startTime = 0;
        timerStarted = false;

        String sentence = JOptionPane.showInputDialog(null, "Enter the sentence for the typing test:");
        if (sentence == null || sentence.trim().isEmpty()) {
            JOptionPane.showMessageDialog(null, "No sentence entered. Exiting.");
            return;
        }

        JFrame frame = new JFrame("Typing Speed Test");
        frame.setSize(900, 500);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JTextArea sentenceArea = new JTextArea(sentence);
        sentenceArea.setLineWrap(true);
        sentenceArea.setWrapStyleWord(true);
        sentenceArea.setEditable(false);
        sentenceArea.setFont(new Font("Times New Roman", Font.ITALIC, 18));
        sentenceArea.setPreferredSize(new Dimension(400, 400));
        sentenceArea.setBorder(BorderFactory.createLineBorder(Color.GRAY, 2));

        JTextArea inputArea = new JTextArea();
        inputArea.setLineWrap(true);
        inputArea.setWrapStyleWord(true);
        inputArea.setFont(new Font("Times New Roman", Font.ITALIC, 18));
        inputArea.setPreferredSize(new Dimension(400, 400));
        inputArea.setTransferHandler(null);
        inputArea.setBorder(BorderFactory.createLineBorder(Color.GRAY, 2));

        JPanel centerPanel = new JPanel(new GridLayout(1, 2, 10, 0));
        centerPanel.add(sentenceArea);
        centerPanel.add(inputArea);

        JLabel resultLabel = new JLabel("Start typing when you're ready...");
        resultLabel.setFont(new Font("Times New Roman", Font.BOLD, 14));

        JButton restartBtn = new JButton("Restart");
        restartBtn.addActionListener(e -> {
            frame.dispose();
            launchApp();
        });

        JPanel bottomPanel = new JPanel(new BorderLayout());
        bottomPanel.add(resultLabel, BorderLayout.CENTER);
        bottomPanel.add(restartBtn, BorderLayout.EAST);

        frame.setLayout(new BorderLayout());
        frame.add(centerPanel, BorderLayout.CENTER);
        frame.add(bottomPanel, BorderLayout.SOUTH);

        inputArea.addKeyListener(new KeyAdapter() {
            public void keyReleased(KeyEvent e) {

                if (!timerStarted && inputArea.getText().length() > 0) {
                    timerStarted = true;
                    startTime = System.currentTimeMillis();
                    resultLabel.setText("Push Your Limit..!!");
                }

                String typed = inputArea.getText();
                if (typed.equals(sentence)) {
                    long end = System.currentTimeMillis();
                    double timeTaken = (end - startTime) / 1000.0;
                    int words = sentence.split(" ").length;
                    double wpm = (words / timeTaken) * 60;
                    resultLabel.setText(
                            String.format("Perfect! Time: %.2f sec | WPM: %.2f", timeTaken, wpm)
                    );
                    inputArea.setEditable(false);
                }
            }
        });
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }
}
